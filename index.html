<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Control Gym üèãÔ∏è</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f8ff; margin: 0; padding: 0; }
    header { text-align: center; padding: 1rem; background: #0077cc; color: white; font-size: 1.5rem; }
    .controls { display: flex; justify-content: center; gap: 10px; margin: 1rem 0; }
    select { padding: 0.5rem; font-size: 1rem; }
    table { width: 100%; max-width: 500px; margin: auto; border-collapse: collapse; }
    th, td { width: 14.28%; text-align: center; padding: 0.5rem; }
    th { background: #0077cc; color: white; }
    td { background: white; cursor: pointer; position: relative; }
    td:hover { background: #e6f7ff; }
    .check { position: absolute; bottom: 4px; right: 4px; font-size: 1rem; color: green; }
    .toast {
      visibility: hidden;
      min-width: 200px;
      background: green;
      color: #fff;
      text-align: center;
      border-radius: 5px;
      padding: 0.5rem;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
    }
    .toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2s; }
    @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 20px; opacity: 1;} }
    @keyframes fadeout { from {bottom: 20px; opacity: 1;} to {bottom: 0; opacity: 0;} }
  </style>
</head>
<body>
  <header>üìÖ Control Gym</header>
  <div class="controls">
    <select id="month"></select>
    <select id="year"></select>
  </div>
  <table>
    <thead>
      <tr>
        <th>Lun</th><th>Mar</th><th>Mi√©</th><th>Jue</th><th>Vie</th><th>S√°b</th><th>Dom</th>
      </tr>
    </thead>
    <tbody id="calendar"></tbody>
  </table>

  <div id="toast" class="toast">Guardado ‚úÖ</div>

  <script>
    const calendar = document.getElementById('calendar');
    const monthSelect = document.getElementById('month');
    const yearSelect = document.getElementById('year');
    const toast = document.getElementById('toast');

    const months = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();

    months.forEach((m,i)=>{
      const opt = document.createElement('option');
      opt.value = i; opt.textContent = m;
      if(i===currentMonth) opt.selected = true;
      monthSelect.appendChild(opt);
    });

    for(let y=currentYear-5; y<=currentYear+5; y++){
      const opt = document.createElement('option');
      opt.value = y; opt.textContent = y;
      if(y===currentYear) opt.selected = true;
      yearSelect.appendChild(opt);
    }

    function showToast() {
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 2500);
    }

    function generateCalendar(month, year){
      calendar.innerHTML = '';
      const firstDay = (new Date(year, month, 1).getDay() + 6) % 7;
      const daysInMonth = new Date(year, month+1, 0).getDate();
      let date = 1;
      for(let i=0;i<6;i++){
        const row = document.createElement('tr');
        for(let j=0;j<7;j++){
          const cell = document.createElement('td');
          if(i===0 && j<firstDay){
            cell.textContent = '';
          }else if(date>daysInMonth){
            cell.textContent = '';
          }else{
            cell.textContent = date;
            const dateString = `${year}-${String(month+1).padStart(2,'0')}-${String(date).padStart(2,'0')}`;
            cell.addEventListener('click',()=>{ window.location.href=`rutinas.html?fecha=${dateString}`; });
            // check si hay datos guardados
            const data = JSON.parse(localStorage.getItem('gymData') || '{}');
            if(data[dateString]){
              const check = document.createElement('span');
              check.textContent = '‚úî';
              check.className = 'check';
              cell.appendChild(check);
            }
            date++;
          }
          row.appendChild(cell);
        }
        calendar.appendChild(row);
      }
    }

    monthSelect.addEventListener('change', ()=> {
      currentMonth = parseInt(monthSelect.value);
      generateCalendar(currentMonth, currentYear);
    });
    yearSelect.addEventListener('change', ()=> {
      currentYear = parseInt(yearSelect.value);
      generateCalendar(currentMonth, currentYear);
    });

    generateCalendar(currentMonth, currentYear);
  </script>
</body>
</html>
