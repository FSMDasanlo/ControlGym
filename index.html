<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ControlGym - Calendario</title>
<link rel="manifest" href="manifest.json">

<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f0f0f0; }
h1 { text-align: center; padding: 10px; background: #007bff; color: white; }
#controles { text-align: center; margin: 10px 0; }
select { padding: 5px; margin: 0 5px; }
#nombres-dias {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  background: #007bff;
  color: white;
  text-align: center;
  font-weight: bold;
}
#nombres-dias div { padding: 5px 0; }
#calendario {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
  max-width: 600px;
  margin: auto;
}
.dia {
  background: white;
  padding: 15px 0;
  text-align: center;
  cursor: pointer;
  position: relative;
  font-size: 16px;
}
.dia:hover { background: #e0e0e0; }
.check {
  position: absolute;
  bottom: 5px;
  right: 5px;
  color: green;
  font-size: 14px;
}
#nombres-dias {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  background: #007bff;
  color: white;
  text-align: center;
  font-weight: bold;
  max-width: 600px;     /* Añadido */
  margin: auto;         /* Añadido */
}

</style>
</head>
<body>
<h1>ControlGym</h1>
<div id="controles">
  <select id="mes"></select>
  <select id="anio"></select>
</div>
<div id="nombres-dias">
  <div>Lun</div><div>Mar</div><div>Mié</div><div>Jue</div><div>Vie</div><div>Sáb</div><div>Dom</div>
</div>
<div id="calendario"></div>

<script>
const mesSelect=document.getElementById('mes');
const anioSelect=document.getElementById('anio');
const calendario=document.getElementById('calendario');
const hoy=new Date();
const data=JSON.parse(localStorage.getItem('gymData')||'{}');

for(let i=0;i<12;i++){
  const opt=document.createElement('option');
  opt.value=i;
  opt.textContent=new Date(0,i).toLocaleString('es',{month:'long'});
  if(i===hoy.getMonth()) opt.selected=true;
  mesSelect.appendChild(opt);
}
for(let i=hoy.getFullYear()-1;i<=hoy.getFullYear()+1;i++){
  const opt=document.createElement('option');
  opt.value=i;
  opt.textContent=i;
  if(i===hoy.getFullYear()) opt.selected=true;
  anioSelect.appendChild(opt);
}

function generarCalendario(){
  calendario.innerHTML='';
  const mes=parseInt(mesSelect.value);
  const anio=parseInt(anioSelect.value);
  const primerDia=new Date(anio,mes,1);
  const ultimoDia=new Date(anio,mes+1,0);
  let inicio=(primerDia.getDay()+6)%7; 
  for(let i=0;i<inicio;i++) calendario.appendChild(document.createElement('div'));
  for(let dia=1;dia<=ultimoDia.getDate();dia++){
    const div=document.createElement('div');
    div.className='dia';
    div.textContent=dia;
    const fechaStr=`${anio}-${String(mes+1).padStart(2,'0')}-${String(dia).padStart(2,'0')}`;
    if(data[fechaStr]) {
      const check=document.createElement('div');
      check.className='check';
      check.textContent='✓';
      div.appendChild(check);
    }
    div.onclick=()=>window.location.href=`rutinas.html?fecha=${fechaStr}`;
    calendario.appendChild(div);
  }
}
mesSelect.onchange=anioSelect.onchange=generarCalendario;
generarCalendario();
</script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(() => console.log('Service Worker registrado'))
    .catch(error => console.error('Error al registrar SW:', error));
}
</script>

</body>
</html>
